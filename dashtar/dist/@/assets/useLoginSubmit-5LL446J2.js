import{r as l,A as E,m as I,h as R,f as v,n as C,e as d}from"./index-CU2_kOLs.js";import{u as D}from"./index.esm-DIMQlkj7.js";import{A as n}from"./AdminServices-D_Y1VEvB.js";import{n as i,a as m}from"./toast-C6v5B_PI.js";import{u as G}from"./useDispatch-DNOf3xOQ.js";const F=()=>{const S=G(),[h,e]=l.useState(!1),{dispatch:c}=l.useContext(E),f=I(),o=R(),{t:y}=v(),{register:x,handleSubmit:A,formState:{errors:N}}=D();return{onSubmit:({name:b,email:p,verifyEmail:L,password:u,role:O})=>{e(!0);const g=.5;o.pathname==="/login"&&(S(C("globalSetting")),n.loginAdmin({email:p,password:u}).then(s=>{s&&(e(!1),i(y("ログイン成功")),c({type:"USER_LOGIN",payload:s}),d.set("adminInfo",JSON.stringify(s),{expires:g,sameSite:"None",secure:!0}),f.replace("/"))}).catch(s=>{var t,a;m(((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.message)||(s==null?void 0:s.message)),e(!1)})),o.pathname==="/signup"&&n.registerAdmin({name:b,email:p,password:u,role:O}).then(s=>{s&&(e(!1),i("Register Success!"),c({type:"USER_LOGIN",payload:s}),d.set("adminInfo",JSON.stringify(s),{expires:g,sameSite:"None",secure:!0}),f.replace("/"))}).catch(s=>{var t,a;m(((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.message)||(s==null?void 0:s.message)),e(!1)}),o.pathname==="/forgot-password"&&n.forgetPassword({verifyEmail:L}).then(s=>{e(!1),i(s.message)}).catch(s=>{var t,a;e(!1),m(((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.message)||(s==null?void 0:s.message))})},register:x,handleSubmit:A,errors:N,loading:h}};export{F as u};
